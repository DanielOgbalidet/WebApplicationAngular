{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"../orders.service\";\nconst _c0 = [\"startDate\"];\nconst _c1 = [\"endDate\"];\nexport class OrderformComponent {\n  constructor(_formbuilder, _router, _orderService, _route) {\n    this._formbuilder = _formbuilder;\n    this._router = _router;\n    this._orderService = _orderService;\n    this._route = _route;\n    this.orderId = -1;\n    this.pricePerNight = 0;\n    this.differenceInDays = 0;\n    this.orderForm = _formbuilder.group({\n      orderDate: [null],\n      userId: [null],\n      houseId: [null],\n      startDate: [null],\n      endDate: [null],\n      totalPrice: [null]\n    });\n  }\n  onSubmit() {\n    this.findDifferenceInDays();\n    const newPrice = this.pricePerNight * this.differenceInDays;\n    this.orderForm.patchValue({\n      totalPrice: newPrice\n    });\n    const newOrder = this.orderForm.value;\n    this._orderService.updateOrder(this.orderId, newOrder).subscribe(response => {\n      if (response.success) {\n        console.log(response.message);\n        this._router.navigate(['/Table']);\n      } else {\n        console.log('Order update failed');\n      }\n    });\n  }\n  ngOnInit() {\n    this._route.params.subscribe(params => {\n      this.orderId = +params['orderId'];\n      this.loadOrderForUpdate(this.orderId);\n    });\n  }\n  loadOrderForUpdate(orderId) {\n    this._orderService.getOrderById(orderId).subscribe(order => {\n      this.orderForm.patchValue({\n        orderDate: order.OrderDate,\n        userId: order.UserId,\n        houseId: order.HouseId,\n        startDate: order.StartDate,\n        endDate: order.EndDate,\n        totalPrice: order.TotalPrice\n      });\n      this.findPricePerNight();\n    }, error => {\n      console.error('Error loading order', error);\n    });\n  }\n  findPricePerNight() {\n    const total = this.orderForm.get(\"totalPrice\")?.value;\n    this.findDifferenceInDays();\n    this.pricePerNight = total / this.differenceInDays;\n  }\n  findDifferenceInDays() {\n    const startDateValue = this.orderForm.get('startDate')?.value;\n    const endDateValue = this.orderForm.get('endDate')?.value;\n    // Turn it into date objects so we can calculate the difference in days\n    const newstartDate = new Date(startDateValue);\n    const newendDate = new Date(endDateValue);\n    // Calculate the difference in milliseconds\n    const differenceInMs = newendDate.getTime() - newstartDate.getTime();\n    // Convert milliseconds to days\n    const differenceInDays = Math.ceil(differenceInMs / (1000 * 60 * 60 * 24));\n  }\n}\nOrderformComponent.ɵfac = function OrderformComponent_Factory(t) {\n  return new (t || OrderformComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.OrderService), i0.ɵɵdirectiveInject(i2.ActivatedRoute));\n};\nOrderformComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: OrderformComponent,\n  selectors: [[\"app-orders-houseform\"]],\n  viewQuery: function OrderformComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(_c0, 5);\n      i0.ɵɵviewQuery(_c1, 5);\n    }\n    if (rf & 2) {\n      let _t;\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.startDate = _t.first);\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.endDate = _t.first);\n    }\n  },\n  decls: 15,\n  vars: 2,\n  consts: [[3, \"formGroup\", \"ngSubmit\"], [1, \"form-group\"], [\"for\", \"start\"], [1, \"bi\", \"bi-cash-coin\"], [\"type\", \"date\", \"id\", \"startDate\", \"formControlName\", \"startDate\", 1, \"form-control\"], [\"for\", \"end\"], [\"type\", \"date\", \"id\", \"endDate\", \"formControlName\", \"endDate\", 1, \"form-control\"], [\"id\", \"save\", \"type\", \"submit\", 1, \"btn\", \"btn-primary\", 3, \"disabled\"], [\"id\", \"cancel\", 1, \"btn\", \"btn-secondary\"]],\n  template: function OrderformComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"form\", 0);\n      i0.ɵɵlistener(\"ngSubmit\", function OrderformComponent_Template_form_ngSubmit_0_listener() {\n        return ctx.onSubmit();\n      });\n      i0.ɵɵelementStart(1, \"div\", 1)(2, \"label\", 2);\n      i0.ɵɵtext(3, \"Start_date \");\n      i0.ɵɵelement(4, \"i\", 3);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(5, \"input\", 4);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(6, \"div\", 1)(7, \"label\", 5);\n      i0.ɵɵtext(8, \"End-date \");\n      i0.ɵɵelement(9, \"i\", 3);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(10, \"input\", 6);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(11, \"button\", 7);\n      i0.ɵɵtext(12, \"Update order\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(13, \"button\", 8);\n      i0.ɵɵtext(14, \"Cancel\");\n      i0.ɵɵelementEnd()();\n    }\n    if (rf & 2) {\n      i0.ɵɵproperty(\"formGroup\", ctx.orderForm);\n      i0.ɵɵadvance(11);\n      i0.ɵɵproperty(\"disabled\", ctx.orderForm.invalid);\n    }\n  },\n  dependencies: [i1.ɵNgNoValidate, i1.DefaultValueAccessor, i1.NgControlStatus, i1.NgControlStatusGroup, i1.FormGroupDirective, i1.FormControlName],\n  styles: [\"body[_ngcontent-%COMP%] {\\r\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvT3JkZXIvb3JkZXJmb3JtL29yZGVyZm9ybS5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0EiLCJzb3VyY2VzQ29udGVudCI6WyJib2R5IHtcclxufVxyXG4iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n});","map":{"version":3,"mappings":";;;;;;AAWA,OAAM,MAAOA,kBAAkB;EAS7BC,YAAoBC,YAAyB,EACnCC,OAAe,EACfC,aAA2B,EAC3BC,MAAsB;IAHZ,iBAAY,GAAZH,YAAY;IACtB,YAAO,GAAPC,OAAO;IACP,kBAAa,GAAbC,aAAa;IACb,WAAM,GAANC,MAAM;IAPhB,YAAO,GAAW,CAAC,CAAC;IACpB,kBAAa,GAAW,CAAC;IACzB,qBAAgB,GAAW,CAAC;IAM1B,IAAI,CAACC,SAAS,GAAGJ,YAAY,CAACK,KAAK,CAAC;MAClCC,SAAS,EAAE,CAAC,IAAI,CAAC;MACjBC,MAAM,EAAE,CAAC,IAAI,CAAC;MACdC,OAAO,EAAE,CAAC,IAAI,CAAC;MACfC,SAAS,EAAE,CAAC,IAAI,CAAC;MACjBC,OAAO,EAAE,CAAC,IAAI,CAAC;MACfC,UAAU,EAAE,CAAC,IAAI;KAClB,CAAC;EACJ;EAEAC,QAAQ;IACN,IAAI,CAACC,oBAAoB,EAAE;IAE3B,MAAMC,QAAQ,GAAG,IAAI,CAACC,aAAa,GAAG,IAAI,CAACC,gBAAgB;IAC3D,IAAI,CAACZ,SAAS,CAACa,UAAU,CAAC;MACxBN,UAAU,EAAEG;KACb,CAAC;IAEF,MAAMI,QAAQ,GAAG,IAAI,CAACd,SAAS,CAACe,KAAK;IAErC,IAAI,CAACjB,aAAa,CAACkB,WAAW,CAAC,IAAI,CAACC,OAAO,EAAEH,QAAQ,CAAC,CACnDI,SAAS,CAACC,QAAQ,IAAG;MACpB,IAAIA,QAAQ,CAACC,OAAO,EAAE;QACpBC,OAAO,CAACC,GAAG,CAACH,QAAQ,CAACI,OAAO,CAAC;QAC7B,IAAI,CAAC1B,OAAO,CAAC2B,QAAQ,CAAC,CAAC,QAAQ,CAAC,CAAC;OAClC,MAAM;QACLH,OAAO,CAACC,GAAG,CAAC,qBAAqB,CAAC;;IAEtC,CAAC,CAAC;EACN;EAEAG,QAAQ;IACN,IAAI,CAAC1B,MAAM,CAAC2B,MAAM,CAACR,SAAS,CAACQ,MAAM,IAAG;MACpC,IAAI,CAACT,OAAO,GAAG,CAACS,MAAM,CAAC,SAAS,CAAC;MACjC,IAAI,CAACC,kBAAkB,CAAC,IAAI,CAACV,OAAO,CAAC;IACvC,CAAC,CAAC;EACJ;EAGAU,kBAAkB,CAACV,OAAe;IAChC,IAAI,CAACnB,aAAa,CAAC8B,YAAY,CAACX,OAAO,CAAC,CACrCC,SAAS,CACPW,KAAU,IAAI;MACb,IAAI,CAAC7B,SAAS,CAACa,UAAU,CAAC;QACxBX,SAAS,EAAE2B,KAAK,CAACC,SAAS;QAC1B3B,MAAM,EAAE0B,KAAK,CAACE,MAAM;QACpB3B,OAAO,EAAEyB,KAAK,CAACG,OAAO;QACtB3B,SAAS,EAAEwB,KAAK,CAACI,SAAS;QAC1B3B,OAAO,EAAEuB,KAAK,CAACK,OAAO;QACtB3B,UAAU,EAAEsB,KAAK,CAACM;OACnB,CAAC;MACF,IAAI,CAACC,iBAAiB,EAAE;IAC1B,CAAC,EACAC,KAAU,IAAI;MACbhB,OAAO,CAACgB,KAAK,CAAC,qBAAqB,EAAEA,KAAK,CAAC;IAC7C,CAAC,CACJ;EACH;EAEAD,iBAAiB;IACf,MAAME,KAAK,GAAG,IAAI,CAACtC,SAAS,CAACuC,GAAG,CAAC,YAAY,CAAC,EAAExB,KAAK;IACrD,IAAI,CAACN,oBAAoB,EAAE;IAE3B,IAAI,CAACE,aAAa,GAAG2B,KAAK,GAAG,IAAI,CAAC1B,gBAAgB;EACpD;EAEAH,oBAAoB;IAClB,MAAM+B,cAAc,GAAG,IAAI,CAACxC,SAAS,CAACuC,GAAG,CAAC,WAAW,CAAC,EAAExB,KAAK;IAC7D,MAAM0B,YAAY,GAAG,IAAI,CAACzC,SAAS,CAACuC,GAAG,CAAC,SAAS,CAAC,EAAExB,KAAK;IAEzD;IACA,MAAM2B,YAAY,GAAG,IAAIC,IAAI,CAACH,cAAc,CAAC;IAC7C,MAAMI,UAAU,GAAG,IAAID,IAAI,CAACF,YAAY,CAAC;IAEzC;IACA,MAAMI,cAAc,GAAGD,UAAU,CAACE,OAAO,EAAE,GAAGJ,YAAY,CAACI,OAAO,EAAE;IAEpE;IACA,MAAMlC,gBAAgB,GAAGmC,IAAI,CAACC,IAAI,CAACH,cAAc,IAAI,IAAI,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,CAAC;EAC5E;;AA5FWnD,kBAAkB;mBAAlBA,kBAAkB;AAAA;AAAlBA,kBAAkB;QAAlBA,kBAAkB;EAAAuD;EAAAC;IAAA;;;;;;;;;;;;;;;MCX/BC,+BAAsD;MAAxBA;QAAA,OAAYC,cAAU;MAAA,EAAC;MACnDD,8BAAwB;MACHA,2BAAW;MAAAA,uBAA+B;MAAAA,iBAAQ;MACrEA,2BAAqF;MACvFA,iBAAM;MACNA,8BAAwB;MACLA,yBAAS;MAAAA,uBAA+B;MAAAA,iBAAQ;MACjEA,4BAAiF;MACnFA,iBAAM;MACNA,kCAAuF;MAAAA,6BAAY;MAAAA,iBAAS;MAC5GA,kCAA8C;MAAAA,uBAAM;MAAAA,iBAAS;;;MAVzDA,yCAAuB;MAS6BA,gBAA8B;MAA9BA,gDAA8B","names":["OrderformComponent","constructor","_formbuilder","_router","_orderService","_route","orderForm","group","orderDate","userId","houseId","startDate","endDate","totalPrice","onSubmit","findDifferenceInDays","newPrice","pricePerNight","differenceInDays","patchValue","newOrder","value","updateOrder","orderId","subscribe","response","success","console","log","message","navigate","ngOnInit","params","loadOrderForUpdate","getOrderById","order","OrderDate","UserId","HouseId","StartDate","EndDate","TotalPrice","findPricePerNight","error","total","get","startDateValue","endDateValue","newstartDate","Date","newendDate","differenceInMs","getTime","Math","ceil","selectors","viewQuery","i0","ctx"],"sourceRoot":"","sources":["C:\\Users\\danie\\WebApplikasjoner\\WebApplicationAngular\\ClientApp\\src\\app\\Order\\orderform\\orderform.component.ts","C:\\Users\\danie\\WebApplikasjoner\\WebApplicationAngular\\ClientApp\\src\\app\\Order\\orderform\\orderform.component.html"],"sourcesContent":["import { Component, OnInit, ViewChild, ElementRef } from '@angular/core';\r\nimport { FormGroup, FormControl, Validators, FormBuilder, ReactiveFormsModule } from '@angular/forms';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { OrderService } from '../orders.service';\r\n\r\n@Component({\r\n  selector: \"app-orders-houseform\",\r\n  templateUrl: \"./orderform.component.html\",\r\n  styleUrls: ['./orderform.component.css']\r\n})\r\n\r\nexport class OrderformComponent {\r\n  @ViewChild('startDate') startDate!: ElementRef;\r\n  @ViewChild('endDate') endDate!: ElementRef;\r\n\r\n  orderForm: FormGroup;\r\n  orderId: number = -1;\r\n  pricePerNight: number = 0;\r\n  differenceInDays: number = 0;\r\n\r\n  constructor(private _formbuilder: FormBuilder,\r\n    private _router: Router,\r\n    private _orderService: OrderService,\r\n    private _route: ActivatedRoute) {\r\n    this.orderForm = _formbuilder.group({\r\n      orderDate: [null],\r\n      userId: [null],\r\n      houseId: [null],\r\n      startDate: [null],\r\n      endDate: [null],\r\n      totalPrice: [null]\r\n    });\r\n  }\r\n\r\n  onSubmit() {\r\n    this.findDifferenceInDays();\r\n\r\n    const newPrice = this.pricePerNight * this.differenceInDays;\r\n    this.orderForm.patchValue({\r\n      totalPrice: newPrice,\r\n    });\r\n\r\n    const newOrder = this.orderForm.value;\r\n\r\n    this._orderService.updateOrder(this.orderId, newOrder)\r\n      .subscribe(response => {\r\n        if (response.success) {\r\n          console.log(response.message);\r\n          this._router.navigate(['/Table']);\r\n        } else {\r\n          console.log('Order update failed');\r\n        }\r\n      });\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this._route.params.subscribe(params => {\r\n      this.orderId = +params['orderId'];\r\n      this.loadOrderForUpdate(this.orderId);\r\n    })\r\n  }\r\n\r\n\r\n  loadOrderForUpdate(orderId: number) {\r\n    this._orderService.getOrderById(orderId)\r\n      .subscribe(\r\n        (order: any) => {\r\n          this.orderForm.patchValue({\r\n            orderDate: order.OrderDate,\r\n            userId: order.UserId,\r\n            houseId: order.HouseId,\r\n            startDate: order.StartDate,\r\n            endDate: order.EndDate,\r\n            totalPrice: order.TotalPrice\r\n          });\r\n          this.findPricePerNight();\r\n        },\r\n        (error: any) => {\r\n          console.error('Error loading order', error);\r\n        }\r\n    )\r\n  }\r\n\r\n  findPricePerNight() {\r\n    const total = this.orderForm.get(\"totalPrice\")?.value;\r\n    this.findDifferenceInDays();\r\n\r\n    this.pricePerNight = total / this.differenceInDays;\r\n  }\r\n\r\n  findDifferenceInDays() {\r\n    const startDateValue = this.orderForm.get('startDate')?.value;\r\n    const endDateValue = this.orderForm.get('endDate')?.value;\r\n\r\n    // Turn it into date objects so we can calculate the difference in days\r\n    const newstartDate = new Date(startDateValue);\r\n    const newendDate = new Date(endDateValue);\r\n\r\n    // Calculate the difference in milliseconds\r\n    const differenceInMs = newendDate.getTime() - newstartDate.getTime();\r\n\r\n    // Convert milliseconds to days\r\n    const differenceInDays = Math.ceil(differenceInMs / (1000 * 60 * 60 * 24));\r\n  }\r\n}\r\n","<form [formGroup]=\"orderForm\" (ngSubmit)=\"onSubmit()\">\r\n  <div class=\"form-group\">\r\n    <label for=\"start\">Start_date <i class=\"bi bi-cash-coin\"></i></label>\r\n    <input type=\"date\" id=\"startDate\" class=\"form-control\" formControlName=\"startDate\" />\r\n  </div>\r\n  <div class=\"form-group\">\r\n    <label for=\"end\">End-date <i class=\"bi bi-cash-coin\"></i></label>\r\n    <input type=\"date\" id=\"endDate\" class=\"form-control\" formControlName=\"endDate\" />\r\n  </div>\r\n  <button id=\"save\" class=\"btn btn-primary\" type=\"submit\" [disabled]=\"orderForm.invalid\">Update order</button>\r\n  <button id=\"cancel\" class=\"btn btn-secondary\">Cancel</button>\r\n</form>\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}